The following sections describes the system design of the iOS application. The overall system design is discussed followed by a more detailed description of how the segues are controlled.

\subsection{Overall system design}
The  system is designed using the model-view-controller principle. Each view is controlled by its own controller class which reacts to user input and triggers changes in the model and updates the view accordingly.
\begin{figure}[ht]
\addScaledImage{0.3}{ios_UML2.png}
\caption{UML diagram.}
\label{fig:ios_UML}
\end{figure}
\FloatBarrier

\refer{fig:ios_UML} gives an overall image of the system design. Some classes are excluded from the figure to make it easier to get an overall idea of the system. The controller classes of the table cells and some other controller classes are not illustrated in the diagram. The non-excluded classes are described in \refer{table:ios_class_table}.

\begin{table}
\begin{tabularx}{\textwidth}{|l|X|}
\hline
\textbf{Class} & \textbf{Description} 
\\ \hline
\term{Annotation} &
Contains information about an annotation and can format the annotation name to an aesthetically more pleasing representation.
\\ \hline

\term{DataFileViewController} &
Controls the File view presented in \refer{fig:ios_files1}. It contains a reference to an experiment and lists all its files in a table.
\\ \hline

\term{Experiment} &
A class that contains information related to an experiment, as well as its files.
\\ \hline

\term{ExperimentDescriber} &
Generates a description of an experiment using annotations chosen by the user.
\\ \hline

\term{ExperimentFile} &
Contains information about a file from an experiment.
\\ \hline

\term{ExperimentParser} &
Parses experiment information from a NSDictionary to an Experiment object.
\\ \hline

\term{FileContainer} &
Contains files and sorts them by file type.
\\ \hline

\term{JSONBuilder} &
Creates different JSON requests.
\\ \hline

\term{PubMedBuilder} &
Creates a pubmed search query.
\\ \hline

\term{SearchResultController} &
A controller class for the Search Results view presented in  \refer{fig:ios_searchResult}. It configures the table which holds the information about the experiments a search resulted in. An ExperimentDescriber is used to generate a description of the experiments.
\\ \hline

\term{SearchViewController} &
A controller class for the Search view, see \refer{fig:ios_search}. It checks which annotation-fields are used and tells the JSONBuilder to generate a corresponding search query when the user presses the search button. The class also contains a advanced search to allow the user to manually enter search queries. 
\\ \hline

\term{SelectedFilesController} &
A controller class for the The selected files view shown in \refer{fig:ios_selectedFiles2}. The selected files controller contains information about files saved by the user.
\\ \hline

\term{ServerConnection} &
Sends and receives JSON objects to and from the server.
\\ \hline
\end{tabularx}

\caption{Description of some classes of the system.}
\label{table:ios_class_table}
\end{table}
\FloatBarrier

A more detailed description of these classes, and the ones not mentioned here, can be found in comments in the source code.

\subsection{Segue controll}
To avoid several segues to be executed at the same time, a segue controll package has been implemented. Instead of extending UIViewController, UITableViewController, UITabBarController and UINavigationBar the corresponding XYZ class should be used instead. An overview of this design can be seen in \refer{fig:ios_UML_segue}. This figure also includes the classes XYZDataFileController and XYZSearchResultController as two examples of such implementations.

\begin{figure}[ht]
\addScaledImage{0.35}{ios_uml_segue2.png}
\caption{UML diagram describing the segue controll.}
\label{fig:ios_UML_segue}
\end{figure}
\FloatBarrier

